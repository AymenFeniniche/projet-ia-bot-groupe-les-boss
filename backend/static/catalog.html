<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>CineAgent â€” Catalogue</title>
  <link rel="stylesheet" href="/static/app.css" />
</head>
<body>
  <header class="container">
    <h1>ðŸ“º Catalogue</h1>
    <p class="subtitle">Films populaires (donnÃ©es live).</p>
    <nav class="nav">
      <a class="btn" href="/static/index.html">Accueil</a>
      <a class="btn primary" href="/static/chat.html">Chatbot</a>
    </nav>
  </header>

  <main class="container">
    <div id="status" class="subtitle">Chargementâ€¦</div>
    <div id="grid" class="grid"></div>
  </main>

  <script>
    async function loadCatalog() {
      const status = document.getElementById("status");
      const grid = document.getElementById("grid");

      try {
        const r = await fetch("/api/debug/search");
        const data = await r.json();

        status.textContent = "RÃ©sultats (TMDB) :";
        grid.innerHTML = "";

        for (const item of data.items) {
          const div = document.createElement("div");
          div.className = "card";

          const title = document.createElement("h2");
          title.textContent = item.title;

          const meta = document.createElement("p");
          const rating = item.rating ? (item.rating + "%") : "N/A";
          meta.className = "meta";
          meta.textContent = `Note: ${rating}`;

          const a = document.createElement("a");
          a.href = item.url;
          a.target = "_blank";
          a.rel = "noreferrer";
          a.textContent = "Voir sur TMDB";

          div.appendChild(title);
          div.appendChild(meta);
          div.appendChild(a);
          grid.appendChild(div);
        }
      } catch (e) {
        status.textContent = "Erreur de chargement du catalogue.";
        grid.innerHTML = "";
        console.error(e);
      }
    }

    loadCatalog();
  </script>
</body>
</html>